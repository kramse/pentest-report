\documentclass[a4paper,11pt,notitlepage]{report}
% Henrik Kramselund, January 2020
% hkj@zencurity.com,
% My standard packages
\usepackage{tex/pentest-report}

\begin{document}

\rm
\selectlanguage{english}

\input{customer.tex}
\mytitle{Penetration Testing Report}{Example A/S}

{\bf this is a sample report, may be copied and reused by anyone! See LICENSE file}


\renewcommand{\baselinestretch}{1}
{\color{titlecolor}\tableofcontents}
%\listoffigures - not used
%\listoftables - not used

\pagestyle{fancyplain}
\normal


\begin{versionhistory}
  \vhEntry{1.0-draft}{2020-09-24}{HKJ}{Created}
%  \vhEntry{1.0}{2020-05-28}{HKJ}{FÃ¦rdig udgave kunde}
%  \vhEntry{1.1}{\today}{HLK}{Customer final - appendix A errors}
\end{versionhistory}


%\renewcommand{\baselinestretch}{2}

\chapter{Introduction}
\markboth{Preface}{}

This report is the result of a penetration test activity performed by Zencurity ApS (Zencurity) against the server IP-addresses provided by customer Template A/S. The activity was performed from February 9. until February 20. 20xx.

The primary goal for this test has been to uncover vulnerabilities in the environment which may allow attackers to gain unauthorised access to the network and servers. No denial-of-service (DoS) attacks has been performed. The report contains the digested summary of the vulnerabilities found in this environment. Further we have included some raw data from some of the tools used in this testing activity.

This is an example report created using the template\\
\link{https://github.com/kramse/pentest-report}

\eject


% Main chapters


\chapter{Target Overview}

Security testing was performed against 6 IP-addresses in use by Template A/S. The targets has been the following IP-addresses::

IP address
Host name
Description
10.0.60.74
No name found
Web server
10.0.60.122
No name found
Web server
10.0.60.123
No name found
VPN server / Netscaler gateway
10.0.60.140
No name found
Web server
10.0.60.194
No name found
Web server
10.0.60.195
No name found
Web server

These addresses are routed by Global Connect and we have no further comments about routing.

Regarding whois information currently states that the subnet should be announced with origin - with the AS number AS25111 or AS2830 - which may have been correct previously.

The objects which are shown in appendix A should be removed is:
\begin{alltt}
% Information related to '10.0.60.0/24AS2830'
route:          10.0.60.0/24
descr:          UUNET
origin:         AS1234
mnt-by:         AS4321-MNT
source:         RIPE # Filtered
\end{alltt}

Since this is marked with AS4321 - it probably requires contacting XXX Networks which are AS4321.

We also noticed that the main domain Template.dk and host name www.Template.dk are not the same IP.
Template.dk has address xx.26.xx.130
Template.dk mail is handled by 10 Template-dk.mail.eo.outlook.com.
www.Template.dk has address xxx.114.xxx.74

Also the IP xxx.26.xxx.130 redirects to www.Template.dk, so we recommend updating the IP to point directly at the real web site and server.




\section{Goal and Strategy}

The review performed is based on data from customer and active testing methods.

We have been given full insight into firewall configuration, Wi-Fi administration, VLAN information, IP address plan etc.

The review contains the following parts and items:

LAN Security Review:
\begin{itemize}
\item Software version of the devices
\item Basic settings NTP, DNS, Syslog, SNMP
\item Networks and VLAN isolation
\end{itemize}

Wi-Fi Security Review:
\begin{itemize}
\item Software version of the devices
\item Networks and managed SSIDs
\item LAN connection settings, VLAN isolation
\item Unmanaged SSIDs
\item Encryption settings
\item Authentication settings
\end{itemize}

VPN Security Review:
\begin{itemize}
\item Software version of the devices
\item Site-2-site VPN
\item Client VPN
\item Encryption settings
\item Authentication settings
\end{itemize}

Firewall review:
\begin{itemize}
\item Software version of the devices
\item Basic settings NTP, DNS, Syslog
\item Management of system and users
\item Management settings including encryption settings and users
\item Firewall Zones
\item Hosts and host groups
\item Services and service groups
\item Firewall Rules
\end{itemize}

\section{Test actions performed}

We have also carried out the following active sub-tasks in this test:
\begin{itemize}
\item Full TCP port scan of outside network - including ports 1-65535
\item Sample TCP port scans of internal network
\item Nmap service scanning - attempted service identification on open ports
\item Sample UDP port scanning and service scan using Nmap UDP probes
\item Metasploit Discovery and port scan tasks of outside network
\item Metasploit Penetration task of outside network
\item TLS scanning using multiple tools for identifying the supported server ciphers
\item DNS lookups, traceroute, ICMP testing and other basic tasks
\item Manual test cases against systems found
\end{itemize}

Port scan includes protocols TCP, UDP and IP scanning utilizing various scanning techniques. The service scan performs deeper identification by sending valid requests for the services, to try to identify the actual open service in more detail.

Due to the nature of the UDP protocol it cannot be fully scanned, and results for UDP are more uncertain. Instead probes have been sent for the most popular protocols in use on top of UDP.

Exploitation has been attempted using exploits against open ports using exploits and specialized scanning for protocols identified.


\chapter{Executive Summary}


\chapter{Executive Summary}
\label{exec-summary}

This report is the result of review activities performed by \company{}. The activities were performed in \duration. Scope has been to perform a  \projecttitle{} of the network at the main site.

The primary goal for this test has been to uncover weaknesses and vulnerabilities in the environment which may allow attackers to gain unauthorised access to the network and servers. We have discovered minor to high risk vulnerabilities in the tested systems.

{\bf examples only, hopefully no customer has all of these!}

The main conclusions are:
\begin{itemize}

\item Port scan and visual inspection has revealed a number of older, insecure and outdated LAN network devices. Also single points of failure, single critical devices are found in the current network\\
We recommend elmininating single point of failure for critical systems and services

\item Port scan has identified a number of unmanaged devices or devices with default vendor credentials

\item The network has a lot of management interfaces that can be attacked from the LAN

\item Port scan has shown that traffic flows internally are almost unrestricted from LAN segments to other parts, and from on-site and into remote segments connected through VPN\\
We recommend implementing basic filtering, to restrict data flows, and to ensure they are in place when needed in the future

\item A malware incident and/or hacker activity in this network would have a high risk of infecting many parts of the infrastructure.\\
We highly recommend creating new zones/VLANs for isolation and segregation

\item Wireless networks managed by \customer{} are encrypted using up-to-date protocols

\item Wireless scan has identified a number of unmanaged wireless networks, or test networks with unknown security levels

\item We have observed that Wi-Fi solutions are configured with multiple SSIDs sharing VLANs.\\
We recommend reconfiguration of the VLAN settings

\item Some wireless network use shared key systems WPA-Personal -- with keys known by former employees that have left the organisation\\
We recommend setting dates for removal of the wireless networks using WPA-Personal shared keys


\item VPN solutions are configured with older and insecure encryption and integrity algorithms.\\
We recommend reconfiguration of the VPN settings

\item Firewall review has identified few problems with the firewall itself, as the firewall was reconfigured recently.

\item Firewall review has shown the current firewall policies to be very open. Current policies allow devices in network segments used by employees, wired and wireless, to communicate freely -- even across production, development and testing facilities. This is not according to best current practice and we recommend creating new zones/VLANs for isolation and segregation

\item Firewall review show that networks are not separated and there is a high likelihood that problems in one area of the network will affect the whole network and all users

\item ...

\end{itemize}

The overall conclusion is that the current network is not sufficiently protected from attacks due to almost no segregation of the zones used. This coupled with a user base that are allowed to connect and disconnect a number of devices, servers and systems create a high risk of security incidents involving large parts of the organisation.

We recommend the following initiatives regarding networks at \customer{} are put into places with a priority to isolate and improve the networks and devices:
\begin{enumerate}
\item Unmanaged devices should be removed or controlled
\item Single point of failure should be eliminated to avoid disruptions to normal business
\item Best current security practices dictate the placement of the management ports on a dedicated management LAN or VLAN restricted to trusted Administrators.
\item VPN site-2-site settings should be updated, and requires few resources. This includes implementing basic filtering, that can be expanded in case of incidents
\item Client VPN solutions should have updated settings, and would benefit from a single solution. Client VPN should also have basic filtering implemented, that can be expanded in case of incidents
\item Traffic flows between segregated networks should be monitored closely
\item Port-security should be used for limiting the use of unmanaged devices, and limiting the effect of connecting other equipment that may affect the networks. Port-security can also be used for automatically joining a connecting user to the right network
\item ...
\end{enumerate}



Finally, Zencurity recommends that \customerlong{} performs periodic security testing of its business to verify that mechanisms and processes implemented to protect critical company assets are working as expected. Especially the processes and mechanisms that will detect and respond to an attack.

OR

We have no further recommendations to the current environment, and can only recommend that the instructions from the vendors are following regarding the administration, software upgrading and control of this environment.

The following sections described in more detail the information uncovered during this testing.

\eject

\chapter{Scanning}
During this testing project we have uncovered open TCP ports and other services, as to be expected from such an environment. The open ports and services have been identified further and examined by tools known as service scanning. We have also concluded that a firewall/filtering device is in place, which can be seen in the responses received - and responses not received for port requests sent.

The open ports and services are shown below. The firewall in place is reported with the port status filtered, which is according to best current practice. Most ports are filtered which is good.

Due to the nature of the UDP protocol it cannot be fully scanned, and results for UDP are more uncertain. Instead probes have been sent for the most popular protocols in use on top of UDP. We have tried sending UDP probes for the 100 most popular UDP ports found on the internet. A full UDP port scan could not be completed as the firewall discards the probes without sending any indication if the UDP ports are open or not.

We have also performed invasive intrusion attempts at the services.

\chapter{Overview of Open Ports}
The found servers and open ports are shown below:

\begin{alltt}\footnotesize
Hosts
=====

address       mac  name          os_name        os_flavor  os_sp  purpose  info  comments
-------       ---  ----          -------        ---------  -----  -------  ----  --------
10.0.60.74        10.0.60.74   Windows                          device
10.0.60.122       10.0.60.122  Windows 7                        client
10.0.60.123       10.0.60.123  embedded                         device
10.0.60.140       10.0.60.140  Windows Vista                    client
10.0.60.194       10.0.60.194  Windows 7                        client
10.0.60.195       10.0.60.195  Windows 2008                     server
\end{alltt}

\begin{alltt}\footnotesize
Services
========

host          port  proto  name   state  info
----          ----  -----  ----   -----  ----
10.0.60.74   80    tcp    http   open   Microsoft-HTTPAPI/2.0

10.0.60.122  80    tcp    http   open    ( 403-Forbidden ( The server denied the specified Uniform Resource Locator (URL). Contact the server administrator.  ) )
10.0.60.122  443   tcp    https  open    ( 403-Forbidden ( The server denied the specified Uniform Resource Locator (URL). Contact the server administrator.  ) )

10.0.60.123  443   tcp    https  open    ( 302-/vpn/tmindex.html )

10.0.60.140  80    tcp    http   open    ( 302-https://10.0.60.140/ )
10.0.60.140  443   tcp    https  open    ( 403-Forbidden ( The page requires a client certificate as part of the authentication process. If you are using a smart card, you will need to insert your smart card to select an appropriate certificate. Otherwise, contact your server administrator.  ) )

10.0.60.194  80    tcp    http   open    ( 403-Forbidden ( The server denied the specified Uniform Resource Locator (URL). Contact the server administrator.  ) )
10.0.60.194  443   tcp    https  open    ( 403-Forbidden ( The server denied the specified Uniform Resource Locator (URL). Contact the server administrator.  ) )

10.0.60.195  80    tcp    http   open    ( 403-Forbidden ( The server denied the specified Uniform Resource Locator (URL). Contact the server administrator.  ) )
10.0.60.195  443   tcp    https  open    ( 403-Forbidden ( The server denied the specified Uniform Resource Locator (URL). Contact the server administrator.  ) )
\end{alltt}




\chapter{Host 10.0.60.74}
We have the following basic information about this host:

\begin{alltt}
Nmap scan report for 10.0.60.74
Host is up (0.017s latency).
Not shown: 65534 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft ISA httpd
|_http-methods: No Allow or Public header in OPTIONS response (status code 404)
|_http-title: Not Found
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
\end{alltt}

The ports and services found are expected with web servers

The ports identified are probably used for:
port 80 HTTP Hypertext Transfer Protocol unencrypted

The protocols are expected in this environment.

Vulnerabilities
We have not uncovered vulnerabilities for this server and have no further recommendations.


\chapter{Host 10.0.60.122}
We have the following basic information about this host:

\begin{alltt}
Nmap scan report for 10.0.60.122
Host is up (0.017s latency).
Not shown: 65533 filtered ports
PORT    STATE SERVICE  VERSION
80/tcp  open  http     Microsoft IIS
|_http-methods: No Allow or Public header in OPTIONS response (status code 403)
|_http-title: The page cannot be displayed
443/tcp open  ssl/http Microsoft IIS
|_http-methods: No Allow or Public header in OPTIONS response (status code 403)
|_http-title: The page cannot be displayed
| ssl-cert: Subject: commonName=*.Template.com/organizationName=Template A/S/stateOrProvinceName=Copenhagen/countryName=DK
| Not valid before: 2010-12-14T11:50:26+00:00
|_Not valid after:  2015-12-14T11:50:24+00:00
|_ssl-date: 2015-02-20T07:49:51+00:00; 0s from local time.
| sslv2:
|   SSLv2 supported
|   ciphers:
|     SSL2_RC4_128_WITH_MD5
|_    SSL2_DES_192_EDE3_CBC_WITH_MD5
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
\end{alltt}

The ports and services found are expected with web servers

The ports identified are probably used for:
\begin{list2}
\item port 80 HTTP Hypertext Transfer Protocol unencrypted
\item port 443 HTTPS Hypertext Transfer Protocol Secure encrypted
\end{list2}

The protocols are expected in this environment.

Vulnerabilities
This server supports SSL version 2 and SSL version 3 both which should be turned off.
\begin{alltt}
Testing SSL server 10.0.60.122 on port 443
  Supported Server Cipher(s):
Accepted  SSLv2    128 bits  RC4-MD5
Accepted  SSLv2    112 bits  DES-CBC3-MD5
Accepted  SSLv3    128 bits  RC4-SHA
Accepted  SSLv3    128 bits  RC4-MD5
Accepted  SSLv3    112 bits  DES-CBC3-SHA
\end{alltt}

We have not uncovered further vulnerabilities for this server and have no further recommendations.


\chapter{Host 10.0.60.123}
We have the following basic information about this host:

\begin{alltt}
Nmap scan report for 10.0.60.123
Host is up (0.018s latency).
Not shown: 65534 filtered ports
PORT    STATE SERVICE   VERSION
443/tcp open  ssl/https
|_http-methods: No Allow or Public header in OPTIONS response (status code 302)
| http-title: NetScaler Gateway
|_Requested resource was /vpn/tmindex.html
| ssl-cert: Subject: commonName=*.Template.com/organizationName=Template A/S/stateOrProvinceName=Copenhagen/countryName=DK
| Not valid before: 2010-12-14T11:50:26+00:00
|_Not valid after:  2015-12-14T11:50:24+00:00
|_ssl-date: 2015-02-20T07:50:04+00:00; +13s from local time.
\end{alltt}

The ports and services found are expected with web servers

The ports identified are probably used for:
port 80 HTTP Hypertext Transfer Protocol unencrypted
port 443 HTTPS Hypertext Transfer Protocol Secure encrypted

The protocols are expected in this environment.

Vulnerabilities
This server supports SSL version 2 and SSL version 3 both which should be turned off.

\begin{alltt}
Testing SSL server 10.0.60.123 on port 443
  Supported Server Cipher(s):
Accepted  SSLv3    256 bits  ECDHE-RSA-AES256-SHA
Accepted  SSLv3    256 bits  AES256-SHA
Accepted  SSLv3    128 bits  ECDHE-RSA-AES128-SHA
Accepted  SSLv3    128 bits  AES128-SHA
Accepted  SSLv3    128 bits  ECDHE-RSA-RC4-SHA
Accepted  SSLv3    128 bits  RC4-SHA
Accepted  SSLv3    128 bits  RC4-MD5
Accepted  SSLv3    112 bits  ECDHE-RSA-DES-CBC3-SHA
Accepted  SSLv3    112 bits  DES-CBC3-SHA
\end{alltt}

We have not uncovered further vulnerabilities for this server and have no further recommendations.



\appendix
\rhead{\fancyplain{}{\bf \leftmark}}
%\setlength{\parskip}{5pt}

\normal

\chapter{Whois}

This section contains the whois information about the customer range. We always perform this lookup to ensure we are targetting the correct customer.

NOTE: in this test we observed that an extra route-object exist, which point to another origin AS number for this range. Customer should instruct network department to fix this to avoid future routing problems.

NOTE: we can see that ZENCURITY-MNT is allowed to make changes to these object, which is probably not relevant anymore and should be removed.

\begin{alltt}
inetnum:        193.0.56.0 - 10.0.60.255
netname:        Template
descr:          Template A/S
country:        DK

% Information related to '10.0.56.0/22AS1234'

route:          10.0.56.0/22
descr:          Template Network
origin:         AS12345
mnt-by:         AS12345-MNT
source:         RIPE # Filtered
\end{alltt}


\chapter{DNS and Name Servers}

We have performed lookups with regards to the main domain Template.dk
Name servers for the domain (host -t ns Template.dk):

\begin{alltt}
Template.dk name server ns1.ascio.net.
Template.dk name server ns2.ascio.net.
ns1.ascio.net has address 185.26.230.9
ns2.ascio.net has address 80.237.153.102
\end{alltt}

We have performed lookups with regards to the main domain Template.com
Name servers for the domain (host -t ns Template.com):
\begin{alltt}
Template.com name server ns2.ascio.net.
Template.com name server ns1.ascio.net.
Template.com name server ns4.ascio.net.
Template.com name server ns3.ascio.net.
ns1.ascio.net has address 185.26.230.9
ns2.ascio.net has address 80.237.153.102
ns3.ascio.net has address 54.183.16.145
ns4.ascio.net has address 72.32.149.232
\end{alltt}

This shows at least two name servers for domains, and these are placed in separate subnets.
No further comments about domains.

\chapter{Test Servers}
We have performed the testing from the IP addresses below:

\begin{list2}
\item 91.102.91.16/28 main test range
\item 185.27.115.0/24 main test range
\item 109.238.48.20 manual verification via VPN
\end{list2}


\bibliographystyle{alpha}
%\bibliography{../ipv6-reference/security6-net.bib,../ipv6-reference/rfc.bib,../ipv6-reference/std.bib,../ipv6-reference/fyi.bib}
%\bibliography{kramse.bib,rfc.bib,std.bib,fyi.bib}
%,internet.bib}

%\printindex

\label{LastPage}
\end{document}
